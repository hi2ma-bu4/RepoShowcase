<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>Mini Witness</title>

	<link rel="stylesheet" href="./style.css">
	<script type="module" src="./main.js"></script>
	<script src="https://hi2ma-bu4.github.io/bio/assets/js/static/auto-gtag.js" async></script>
</head>
<body>
	<div id="ui-overlay">
		<h1>Mini Witness</h1>
		<div class="controls">
			<div class="control-group">
				<label for="size-select">Grid Size:</label>
				<select id="size-select">
					<option value="2">2x2</option>
					<option value="3">3x3</option>
					<option value="4" selected>4x4</option>
					<option value="5">5x5</option>
					<option value="6">6x6</option>
					<option value="7">7x7</option>
					<option value="8">8x8</option>
					<option value="9">9x9</option>
					<option value="10">10x10</option>
					<option value="11">11x11</option>
					<option value="12">12x12</option>
				</select>
			</div>
			<div class="control-group">
				<label><input type="checkbox" id="use-hexagons"> Hexagons</label>
				<label><input type="checkbox" id="use-squares" checked> Squares</label>
				<label><input type="checkbox" id="use-stars" checked> Stars</label>
				<label><input type="checkbox" id="use-tetris" checked> Tetris</label>
				<label><input type="checkbox" id="use-tetris-negative"> Tetris-</label>
				<label><input type="checkbox" id="use-eraser"> Erasers</label>
				<label><input type="checkbox" id="use-triangles"> Triangles</label>
				<label><input type="checkbox" id="use-broken-edges"> Cuts</label>
			</div>
			<div class="control-group">
				<label for="symmetry-select">Symmetry:</label>
				<select id="symmetry-select">
					<option value="0">None</option>
					<option value="1">Horizontal</option>
					<option value="2">Vertical</option>
					<option value="3">Rotational</option>
				</select>
				<label for="sym-color-select">Color:</label>
				<select id="sym-color-select">
					<option value="rgba(255, 255, 255, 0.5)">White (Half)</option>
					<option value="#00f">Blue</option>
					<option value="#ff0">Yellow</option>
					<option value="transparent">Transparent</option>
				</select>
			</div>
			<details class="advanced-settings">
				<summary>Advanced Settings</summary>
				<div class="control-group">
					<label><input type="checkbox" id="custom-theme" checked> Custom Theme</label>
					<label for="worker-select">Worker:</label>
					<select id="worker-select">
						<option value="0">None</option>
						<option value="1">Custom (worker.js)</option>
						<option value="2">Direct (MiniWitness.js)</option>
					</select>
					<label><input type="checkbox" id="blink-marks" checked> Blink Marks</label>
					<label><input type="checkbox" id="stay-path" checked> Stay Path</label>
					<label><input type="checkbox" id="use-hidpi" checked> High DPI</label>
					<label for="input-mode-select">Input:</label>
					<select id="input-mode-select">
						<option value="drag" selected>Drag</option>
						<option value="twoClick">2 Click</option>
					</select>
				</div>
				<div class="control-group">
					<label for="complexity-slider">Complexity (Constraint Density):</label>
					<input type="range" id="complexity-slider" min="0" max="1" step="0.1" value="1">
				</div>
				<div class="control-group">
					<label for="difficulty-slider">Difficulty (Hardest at 1.0):</label>
					<input type="range" id="difficulty-slider" min="0" max="1" step="0.1" value="1">
				</div>
				<div class="control-group">
					<label for="path-length-slider">Path Length (Longest at 1.0):</label>
					<input type="range" id="path-length-slider" min="0" max="1" step="0.1" value="0.5">
				</div>
				<div class="control-group">
					<label for="seed-input">Seed (Hex):</label>
					<input type="text" id="seed-input" placeholder="Random" style="width: 100px;">
					<label for="rng-select">RNG:</label>
					<select id="rng-select">
						<option value="0">Mulberry32</option>
						<option value="1">XorShift128+</option>
						<option value="2">Math.random</option>
					</select>
				</div>
			</details>
			<details class="advanced-settings">
				<summary>Custom Create</summary>
				<div class="control-group">
					<label><input type="checkbox" id="custom-mode-toggle"> Enable Custom Create</label>
					<span id="custom-tool-indicator">Edit on canvas: OFF</span>
				</div>
				<div id="custom-create-tools" class="hidden">
					<div class="control-group">
						<span class="custom-hint">Canvas上を直接編集: タップで循環変更 / 長押しで削除。
							ツールと色はCanvas左上のオーバーレイから選択できます。</span>
					</div>
					<div class="control-group">
						<button id="custom-sync-btn" type="button">Sync from Current Puzzle</button>
						<button id="custom-clear-btn" type="button">Clear Board</button>
						<button id="custom-apply-btn" type="button">Apply (optional)</button>
					</div>
					<div class="control-group custom-editor-group">
						<label for="custom-share-code">Custom Share Code (Puzzle only)</label>
						<textarea id="custom-share-code" rows="3" spellcheck="false" placeholder="Paste code or generate code"></textarea>
					</div>
					<div class="control-group">
						<button id="custom-share-btn" type="button">Copy Custom Share Code</button>
						<button id="custom-load-btn" type="button">Load from Custom Share Code</button>
					</div>
					<details class="advanced-settings">
						<summary>Advanced JSON Editor</summary>
						<div class="control-group custom-editor-group">
							<label for="custom-puzzle-json">Puzzle JSON</label>
							<textarea id="custom-puzzle-json" rows="10" spellcheck="false"></textarea>
						</div>
					</details>
				</div>
			</details>
			<details class="advanced-settings">
				<summary>Share Settings</summary>
				<div class="control-group">
					<label><input type="checkbox" id="share-puzzle" checked> Puzzle</label>
					<label><input type="checkbox" id="share-seed"> Seed</label>
					<label><input type="checkbox" id="share-options" checked> Options</label>
					<label><input type="checkbox" id="share-path"> Path</label>
					<label><input type="checkbox" id="share-filter"> Filter</label>
				</div>
				<div class="control-group">
					<label for="parity-mode">Parity:</label>
					<select id="parity-mode">
						<option value="detection" selected>Detection (Fast)</option>
						<option value="recovery">Recovery (Robust)</option>
					</select>
				</div>
			</details>
			<div class="control-group">
				<label><input type="checkbox" id="filter-enabled"> Filter</label>
				<label for="filter-mode">Filter Mode:</label>
				<select id="filter-mode">
					<option value="rgb" selected>RGB</option>
					<option value="custom">Custom</option>
				</select>
				<label for="filter-custom-color">Custom Color:</label>
				<input id="filter-custom-color" type="color" value="#ff00ff">
			</div>
			<div class="control-group">
				<button id="new-puzzle-btn">New Puzzle</button>
				<button id="share-puzzle-btn">Share Puzzle</button>
			</div>
		</div>
		<div id="status-message">Draw a path from the large circle to the exit!</div>
	</div>

	<div id="game-container">
		<canvas id="game-canvas"></canvas>
	</div>

	<div id="filter-switcher" class="hidden">
		<div id="filter-switcher-rgb" class="control-group hidden">
			<button id="filter-r-btn">R</button>
			<button id="filter-g-btn">G</button>
			<button id="filter-b-btn">B</button>
		</div>
		<div id="filter-switcher-custom" class="control-group hidden">
			<button id="filter-primary-btn">原色</button>
			<button id="filter-custom-btn">カスタム</button>
		</div>
	</div>

	<div id="event-log-container">
		<div id="event-log-title">Internal Events:</div>
		<div id="event-log"></div>
	</div>

	<div class="instructions">
		<p><strong>操作方法:</strong> 始点（大きな丸）からドラッグまたはクリックで線を引き、出口まで繋げてください。</p>
	</div>
	<footer id="copyright">
		<p><a href="https://store.steampowered.com/app/210970/The_Witness/" target="_blank" rel="noopener">Based on The Witness (Steam)</a></p>
		<a href="https://github.com/hi2ma-bu4/MiniWitness" target="_blank" rel="noopener">
			MiniWitness © 2026 hi2ma-bu4
		</a>
	</footer>
</body>
</html>
