/*!
 * SnowFall2 v0.4.1
 * Copyright 2026 hi2ma-bu4
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var xe=Object.defineProperty;var Ie=(t,e)=>{for(var n in e)xe(t,n,{get:e[n],enumerable:!0})};var z={};Ie(z,{WasmCompileResult:()=>C,compile:()=>Me,default:()=>H,execute:()=>Ne,free_memory:()=>Ue,free_memory_with_len:()=>Be,initSync:()=>ze,lexer:()=>ve,main_init:()=>Pe,normalize:()=>Xe,parser:()=>ke,version:()=>Le});var i;function Te(t){let e=i.__externref_table_alloc();return i.__wbindgen_externrefs.set(e,t),e}function ne(t,e){return t=t>>>0,y().subarray(t/1,t/1+e)}var E=null;function ee(){return(E===null||E.buffer.detached===!0||E.buffer.detached===void 0&&E.buffer!==i.memory.buffer)&&(E=new DataView(i.memory.buffer)),E}function T(t,e){return t=t>>>0,Fe(t,e)}var R=null;function y(){return(R===null||R.byteLength===0)&&(R=new Uint8Array(i.memory.buffer)),R}function Re(t,e){try{return t.apply(this,e)}catch(n){let r=Te(n);i.__wbindgen_exn_store(r)}}function De(t,e){let n=e(t.length*1,1)>>>0;return y().set(t,n/1),b=t.length,n}function O(t,e,n){if(n===void 0){let c=D.encode(t),f=e(c.length,1)>>>0;return y().subarray(f,f+c.length).set(c),b=c.length,f}let r=t.length,o=e(r,1)>>>0,a=y(),s=0;for(;s<r;s++){let c=t.charCodeAt(s);if(c>127)break;a[o+s]=c}if(s!==r){s!==0&&(t=t.slice(s)),o=n(o,r,r=s+t.length*3,1)>>>0;let c=y().subarray(o+s,o+r),f=D.encodeInto(t,c);s+=f.written,o=n(o,r,s,1)>>>0}return b=s,o}function h(t){let e=i.__wbindgen_externrefs.get(t);return i.__externref_table_dealloc(t),e}var v=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});v.decode();var Oe=2146435072,W=0;function Fe(t,e){return W+=e,W>=Oe&&(v=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),v.decode(),W=e),v.decode(y().subarray(t,t+e))}var D=new TextEncoder;"encodeInto"in D||(D.encodeInto=function(t,e){let n=D.encode(t);return e.set(n),{read:t.length,written:n.length}});var b=0,te=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>i.__wbg_wasmcompileresult_free(t>>>0,1)),C=class t{static __wrap(e){e=e>>>0;let n=Object.create(t.prototype);return n.__wbg_ptr=e,te.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,te.unregister(this),e}free(){let e=this.__destroy_into_raw();i.__wbg_wasmcompileresult_free(e,0)}get binary(){let e=i.wasmcompileresult_binary(this.__wbg_ptr),n;return e[0]!==0&&(n=ne(e[0],e[1]).slice(),i.__wbindgen_free(e[0],e[1]*1,1)),n}get errors(){return i.wasmcompileresult_errors(this.__wbg_ptr)}};Symbol.dispose&&(C.prototype[Symbol.dispose]=C.prototype.free);function Me(t,e){let n=O(t,i.__wbindgen_malloc,i.__wbindgen_realloc),r=b,o=i.compile(n,r,e);return C.__wrap(o)}function Ne(t){let e=De(t,i.__wbindgen_malloc),n=b,r=i.execute(e,n);if(r[2])throw h(r[1]);return h(r[0])}function Ue(t,e){i.free_memory(t,e)}function Be(t,e,n){i.free_memory_with_len(t,e,n)}function ve(t){let e=O(t,i.__wbindgen_malloc,i.__wbindgen_realloc),n=b,r=i.lexer(e,n);if(r[2])throw h(r[1]);return h(r[0])}function Pe(){i.main_init()}function Xe(t){let e=O(t,i.__wbindgen_malloc,i.__wbindgen_realloc),n=b,r=i.normalize(e,n);if(r[2])throw h(r[1]);return h(r[0])}function ke(t){let e=O(t,i.__wbindgen_malloc,i.__wbindgen_realloc),n=b,r=i.parser(e,n);if(r[2])throw h(r[1]);return h(r[0])}function Le(){let t,e;try{let n=i.version();return t=n[0],e=n[1],T(n[0],n[1])}finally{i.__wbindgen_free(t,e,1)}}var We=new Set(["basic","cors","default"]);async function He(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.ok&&We.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}let n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{let n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function re(){let t={};return t.wbg={},t.wbg.__wbg_Error_52673b7de5a0ca89=function(e,n){return Error(T(e,n))},t.wbg.__wbg___wbindgen_is_string_704ef9c8fc131030=function(e){return typeof e=="string"},t.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(e,n){throw new Error(T(e,n))},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,o;try{r=e,o=n,console.error(T(e,n))}finally{i.__wbindgen_free(r,o,1)}},t.wbg.__wbg_getRandomValues_1c61fac11405ffdc=function(){return Re(function(e,n){globalThis.crypto.getRandomValues(ne(e,n))},arguments)},t.wbg.__wbg_new_1ba21ce319a06297=function(){return new Object},t.wbg.__wbg_new_25f239778d6112b9=function(){return new Array},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_new_b546ae120718850e=function(){return new Map},t.wbg.__wbg_set_3f1d0b984ed272ed=function(e,n,r){e[n]=r},t.wbg.__wbg_set_7df433eea03a5c14=function(e,n,r){e[n>>>0]=r},t.wbg.__wbg_set_efaaf145b9377369=function(e,n,r){return e.set(n,r)},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){let r=n.stack,o=O(r,i.__wbindgen_malloc,i.__wbindgen_realloc),a=b;ee().setInt32(e+4,a,!0),ee().setInt32(e+0,o,!0)},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,n){return T(e,n)},t.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},t.wbg.__wbindgen_cast_9ae0607507abb057=function(e){return e},t.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(e){return e},t.wbg.__wbindgen_init_externref_table=function(){let e=i.__wbindgen_externrefs,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t}function ie(t,e){return i=t.exports,oe.__wbindgen_wasm_module=e,E=null,R=null,i.__wbindgen_start(),i}function ze(t){if(i!==void 0)return i;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module:t}=t:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));let e=re();t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t));let n=new WebAssembly.Instance(t,e);return ie(n,t)}async function oe(t){if(i!==void 0)return i;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("snowfall_core_bg.wasm",import.meta.url));let e=re();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));let{instance:n,module:r}=await He(await t,e);return ie(n,r)}var H=oe;var S=class extends Error{type;code;line;column;trace;context;constructor(e){super(e.message),this.name=this.constructor.name,this.type=e.type,this.code=e.code,this.line=e.line,this.column=e.column,this.trace=e.trace,this.context=e.context,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}};function se(t){let e="";for(let n=0;n<t.length;n+=16384)e+=String.fromCharCode(...t.subarray(n,n+16384));return e}var A=class{static isDebug=!1;static prefix="SnowFall";static info(...e){this.isDebug&&console.log(`[${this.prefix}]`,...e)}static warn(...e){console.warn(`[${this.prefix}]`,...e)}static error(...e){console.error(`[${this.prefix}]`,...e)}};var Y=typeof Uint8Array<"u"&&typeof Uint16Array<"u",ce=!1;try{String.fromCharCode.apply(null,[97])==="a"&&(ce=!0)}catch{}var le=ce,_e=!1;if(Y)try{String.fromCharCode.apply(null,new Uint8Array([97]))==="a"&&(_e=!0)}catch{}var fe=_e,d=65533,x=null;function F(t){x=t}var ue=!1;"abc\u307B\u3052".lastIndexOf("\u307B\u3052",1)!==-1&&(ue=!0);var pe=ue,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",p=P.length,ge=Math.max(p,62)-Math.min(p,62),I=p-1,M=1024,j=304,K=d,be=K-p,de=d,Ye=de+M*2,ae=11,me=ae*(ae+1),g=40,N=g*(g+1),Z=p+1,he=ge+20,V=p+5,je=p-ge-19,we=g+7,X=we+1,k=X+1,L=k+5,Ke=L+5;var U=String.fromCharCode;function G(t,e){if(Y)switch(t){case 8:return new Uint8Array(e);case 16:return new Uint16Array(e)}return new Array(e)}function Ze(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)}function q(t,e){if(e==null?e=t.length:t=Ze(t,e),le&&fe){let n=t.length;if(n<d&&x)return U.apply(null,t);if(x===null)try{let r=U.apply(null,t);return n>d&&F(!0),r}catch{F(!1)}}return Ve(t)}function Ve(t){let e="",n=t.length,r=0,o;for(;r<n;){if(!Array.isArray(t)&&t.subarray?o=t.subarray(r,r+d):o=t.slice(r,r+d),r+=d,x){e+=U.apply(null,o);continue}if(x===null)try{e+=U.apply(null,o),o.length>d&&F(!0);continue}catch{F(!1)}return $e(t)}return e}function $e(t){let e="",n=t.length;for(let r=0;r<n;r++)e+=U(t[r]);return e}function J(){let t=M>>7,e="        ";for(;!(t&M);)e+=e,t<<=1;return e}var B=class{_data=null;_table=null;_result=null;_onDataCallback;_onEndCallback;_offset=0;_dataLen=0;_index=0;_length=0;constructor(e){this._init(e)}_init(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}_createTable(){let e=G(8,p);for(let n=0;n<p;n++)e[n]=P.charCodeAt(n);return e}_onData(e,n){let r=q(e,n);this._onDataCallback?this._onDataCallback(r):this._result!==null&&(this._result+=r)}_onEnd(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null}_search(){let e=2,n=this._data,r=this._offset,o=I;if(this._dataLen-r<o&&(o=this._dataLen-r),e>o)return!1;let a=r-j,s=n.substring(a,r+o),c=r+e-3-a,f,_,l,u,m,w;do{if(e===2){if(_=n.charAt(r)+n.charAt(r+1),l=s.indexOf(_),l===-1||l>c)break}else e===3?_=_+n.charAt(r+2):_=n.substr(r,e);if(pe?(w=n.substring(a,r+e-1),u=w.lastIndexOf(_)):u=s.lastIndexOf(_,c),u===-1)break;m=u,f=a+u;do if(n.charCodeAt(r+e)!==n.charCodeAt(f+e))break;while(++e<o);if(l===u){e++;break}}while(++e<o);return e===2?!1:(this._index=j-m,this._length=e-1,!0)}compress(e){if(e==null||e.length===0)return"";let n="",r=this._createTable(),o=J(),a=G(8,K),s=0;this._result="",this._offset=o.length,this._data=o+e,this._dataLen=this._data.length;let c=-1,f=-1,_,l,u,m,w;for(;this._offset<this._dataLen;)this._search()?(this._index<I?(l=this._index,u=0):(l=this._index%I,u=(this._index-l)/I),this._length===2?(a[s++]=r[u+L],a[s++]=r[l]):(a[s++]=r[u+k],a[s++]=r[l],a[s++]=r[this._length]),this._offset+=this._length,~f&&(f=-1)):(_=this._data.charCodeAt(this._offset++),_<me?(_<g?(l=_,c=Z):(l=_%g,u=(_-l)/g,c=u+Z),f===c?a[s++]=r[l]:(a[s++]=r[c-he],a[s++]=r[l],f=c)):(_<N?(c=V,l=_):(l=_%N,u=(_-l)/N,c=u+V),l<g?(m=l,w=0):(m=l%g,w=(l-m)/g),f===c?(a[s++]=r[m],a[s++]=r[w]):(a[s++]=r[X],a[s++]=r[c-p],a[s++]=r[m],a[s++]=r[w],f=c))),s>=be&&(this._onData(a,s),s=0);return s>0&&this._onData(a,s),this._onEnd(),n=this._result,this._result=null,n===null?"":n}};function Ae(t,e){return new B(e).compress(t)}function Q(t){let e=/^v?(\d+)\.(\d+)\.(\d+)$/.exec(t);return e?{major:Number(e[1]),minor:Number(e[2]),patch:Number(e[3])}:null}function ye(t,e){return t.major!==e.major?{kind:"err",message:`MAJOR mismatch: ts=${t.major}, rust=${e.major}`}:t.minor!==e.minor?{kind:"err",message:`MINOR mismatch: ts=${t.minor}, rust=${e.minor}`}:t.patch!==e.patch?{kind:"warn",message:`PATCH mismatch: ts=${t.patch}, rust=${e.patch}`}:{kind:"ok"}}var Ce="v0.4.1";var Se=class{_wasm=null;_isInitialized=!1;constructor(e=!1){A.isDebug=e}async init(e){if(!this._isInitialized){try{await H(e)}catch(n){throw A.error("Failed to initialize SnowFall Wasm module:",n),n}this._wasm=z,this._versionCheck(),this._isInitialized=!0,A.info("SnowFall Wasm module initialized successfully.")}}ensureInitialized(){if(!this._wasm||!this._isInitialized)throw new Error("SnowFall has not been initialized. Please call init() first.");return this._wasm}version(){return Ce}version_wasm(){return this.ensureInitialized().version()}compile_bin(e,n){let o=this.ensureInitialized().compile(e,n);try{let a=o.errors;if(a){let c=a;if(Array.isArray(c)&&c.length>0)return{errors:c.map(f=>new S(f))}}let s=o.binary;return s?{binary:s}:{}}finally{o.free()}}compile(e,n){let r=this.compile_bin(e,n);return r.errors?{errors:r.errors}:r.binary?{data:Ae(se(r.binary))}:{}}execute(e){let n=this.ensureInitialized();try{return{value:n.execute(e)}}catch(r){return console.error(r),{error:r}}}dev_lexer(e){return this.ensureInitialized().lexer(e)}dev_parser(e){let r=this.ensureInitialized().parser(e);return r.errors?{...r,errors:r.errors.map(o=>new S(o))}:r}dev_normalize(e){let r=this.ensureInitialized().normalize(e);return r.errors?{...r,errors:r.errors.map(o=>new S(o))}:r}_versionCheck(){if(!this._wasm)return;let e=Q(this.version()),n=Q(this._wasm.version());if(!e||!n)throw new Error("Invalid version format (expected x.y.z)");let r=ye(e,n);switch(r.kind){case"ok":return;case"warn":A.warn("[Version]",r.message);return;case"err":throw new Error(`[Version] ${r.message}`)}}};export{Se as SnowFall};
/*!
 * lzbase62 v2.0.0 - LZ77(LZSS) based compression algorithm in base62 for JavaScript
 * Copyright (c) 2014-2020 polygon planet <polygon.planet.aqua@gmail.com>
 * https://github.com/polygonplanet/lzbase62
 * @license MIT
 *
 * Forked and modified by SnowFall2 Project
 * Modifications:
 * - Converted from JavaScript to TypeScript
 * - Added type definitions
 */
/**
 * forked from lzbase62
 * @module lzbase62
 * @see https://github.com/polygonplanet/lzbase62
 * @license MIT
 * @version 2.0.0
 */
//# sourceMappingURL=snowfall.min.js.map
