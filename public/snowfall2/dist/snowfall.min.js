/*!
 * SnowFall2 v0.4.1
 * Copyright 2026 hi2ma-bu4
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var xe=Object.defineProperty;var Ie=(t,e)=>{for(var n in e)xe(t,n,{get:e[n],enumerable:!0})};var z={};Ie(z,{WasmCompileResult:()=>y,compile:()=>Fe,default:()=>H,free_memory:()=>Me,free_memory_with_len:()=>Ne,initSync:()=>We,lexer:()=>Ue,main_init:()=>Be,normalize:()=>ve,parser:()=>Pe,version:()=>Xe});var o;function Re(t){let e=o.__externref_table_alloc();return o.__wbindgen_externrefs.set(e,t),e}function ne(t,e){return t=t>>>0,T().subarray(t/1,t/1+e)}var h=null;function ee(){return(h===null||h.buffer.detached===!0||h.buffer.detached===void 0&&h.buffer!==o.memory.buffer)&&(h=new DataView(o.memory.buffer)),h}function I(t,e){return t=t>>>0,Oe(t,e)}var R=null;function T(){return(R===null||R.byteLength===0)&&(R=new Uint8Array(o.memory.buffer)),R}function Te(t,e){try{return t.apply(this,e)}catch(n){let r=Re(n);o.__wbindgen_exn_store(r)}}function O(t,e,n){if(n===void 0){let c=D.encode(t),f=e(c.length,1)>>>0;return T().subarray(f,f+c.length).set(c),w=c.length,f}let r=t.length,i=e(r,1)>>>0,a=T(),s=0;for(;s<r;s++){let c=t.charCodeAt(s);if(c>127)break;a[i+s]=c}if(s!==r){s!==0&&(t=t.slice(s)),i=n(i,r,r=s+t.length*3,1)>>>0;let c=T().subarray(i+s,i+r),f=D.encodeInto(t,c);s+=f.written,i=n(i,r,s,1)>>>0}return w=s,i}function A(t){let e=o.__wbindgen_externrefs.get(t);return o.__externref_table_dealloc(t),e}var v=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});v.decode();var De=2146435072,W=0;function Oe(t,e){return W+=e,W>=De&&(v=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),v.decode(),W=e),v.decode(T().subarray(t,t+e))}var D=new TextEncoder;"encodeInto"in D||(D.encodeInto=function(t,e){let n=D.encode(t);return e.set(n),{read:t.length,written:n.length}});var w=0,te=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>o.__wbg_wasmcompileresult_free(t>>>0,1)),y=class t{static __wrap(e){e=e>>>0;let n=Object.create(t.prototype);return n.__wbg_ptr=e,te.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,te.unregister(this),e}free(){let e=this.__destroy_into_raw();o.__wbg_wasmcompileresult_free(e,0)}get binary(){let e=o.wasmcompileresult_binary(this.__wbg_ptr),n;return e[0]!==0&&(n=ne(e[0],e[1]).slice(),o.__wbindgen_free(e[0],e[1]*1,1)),n}get errors(){return o.wasmcompileresult_errors(this.__wbg_ptr)}};Symbol.dispose&&(y.prototype[Symbol.dispose]=y.prototype.free);function Fe(t,e){let n=O(t,o.__wbindgen_malloc,o.__wbindgen_realloc),r=w,i=o.compile(n,r,e);return y.__wrap(i)}function Me(t,e){o.free_memory(t,e)}function Ne(t,e,n){o.free_memory_with_len(t,e,n)}function Ue(t){let e=O(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=w,r=o.lexer(e,n);if(r[2])throw A(r[1]);return A(r[0])}function Be(){o.main_init()}function ve(t){let e=O(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=w,r=o.normalize(e,n);if(r[2])throw A(r[1]);return A(r[0])}function Pe(t){let e=O(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=w,r=o.parser(e,n);if(r[2])throw A(r[1]);return A(r[0])}function Xe(){let t,e;try{let n=o.version();return t=n[0],e=n[1],I(n[0],n[1])}finally{o.__wbindgen_free(t,e,1)}}var ke=new Set(["basic","cors","default"]);async function Le(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.ok&&ke.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}let n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{let n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function re(){let t={};return t.wbg={},t.wbg.__wbg_Error_52673b7de5a0ca89=function(e,n){return Error(I(e,n))},t.wbg.__wbg___wbindgen_is_string_704ef9c8fc131030=function(e){return typeof e=="string"},t.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(e,n){throw new Error(I(e,n))},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,i;try{r=e,i=n,console.error(I(e,n))}finally{o.__wbindgen_free(r,i,1)}},t.wbg.__wbg_getRandomValues_1c61fac11405ffdc=function(){return Te(function(e,n){globalThis.crypto.getRandomValues(ne(e,n))},arguments)},t.wbg.__wbg_new_1ba21ce319a06297=function(){return new Object},t.wbg.__wbg_new_25f239778d6112b9=function(){return new Array},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_new_b546ae120718850e=function(){return new Map},t.wbg.__wbg_set_3f1d0b984ed272ed=function(e,n,r){e[n]=r},t.wbg.__wbg_set_7df433eea03a5c14=function(e,n,r){e[n>>>0]=r},t.wbg.__wbg_set_efaaf145b9377369=function(e,n,r){return e.set(n,r)},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){let r=n.stack,i=O(r,o.__wbindgen_malloc,o.__wbindgen_realloc),a=w;ee().setInt32(e+4,a,!0),ee().setInt32(e+0,i,!0)},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,n){return I(e,n)},t.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},t.wbg.__wbindgen_cast_9ae0607507abb057=function(e){return e},t.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(e){return e},t.wbg.__wbindgen_init_externref_table=function(){let e=o.__wbindgen_externrefs,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t}function ie(t,e){return o=t.exports,oe.__wbindgen_wasm_module=e,h=null,R=null,o.__wbindgen_start(),o}function We(t){if(o!==void 0)return o;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module:t}=t:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));let e=re();t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t));let n=new WebAssembly.Instance(t,e);return ie(n,t)}async function oe(t){if(o!==void 0)return o;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("snowfall_core_bg.wasm",import.meta.url));let e=re();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));let{instance:n,module:r}=await Le(await t,e);return ie(n,r)}var H=oe;var C=class extends Error{type;code;line;column;trace;context;constructor(e){super(e.message),this.name=this.constructor.name,this.type=e.type,this.code=e.code,this.line=e.line,this.column=e.column,this.trace=e.trace,this.context=e.context,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}};function se(t){let e="";for(let n=0;n<t.length;n+=16384)e+=String.fromCharCode(...t.subarray(n,n+16384));return e}var E=class{static isDebug=!1;static prefix="SnowFall";static info(...e){this.isDebug&&console.log(`[${this.prefix}]`,...e)}static warn(...e){console.warn(`[${this.prefix}]`,...e)}static error(...e){console.error(`[${this.prefix}]`,...e)}};var Y=typeof Uint8Array<"u"&&typeof Uint16Array<"u",ce=!1;try{String.fromCharCode.apply(null,[97])==="a"&&(ce=!0)}catch{}var le=ce,_e=!1;if(Y)try{String.fromCharCode.apply(null,new Uint8Array([97]))==="a"&&(_e=!0)}catch{}var fe=_e,b=65533,S=null;function F(t){S=t}var ue=!1;"abc\u307B\u3052".lastIndexOf("\u307B\u3052",1)!==-1&&(ue=!0);var pe=ue,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",p=P.length,ge=Math.max(p,62)-Math.min(p,62),x=p-1,M=1024,j=304,K=b,be=K-p,de=b,He=de+M*2,ae=11,me=ae*(ae+1),g=40,N=g*(g+1),Z=p+1,he=ge+20,V=p+5,ze=p-ge-19,we=g+7,X=we+1,k=X+1,L=k+5,Ye=L+5;var U=String.fromCharCode;function G(t,e){if(Y)switch(t){case 8:return new Uint8Array(e);case 16:return new Uint16Array(e)}return new Array(e)}function je(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)}function q(t,e){if(e==null?e=t.length:t=je(t,e),le&&fe){let n=t.length;if(n<b&&S)return U.apply(null,t);if(S===null)try{let r=U.apply(null,t);return n>b&&F(!0),r}catch{F(!1)}}return Ke(t)}function Ke(t){let e="",n=t.length,r=0,i;for(;r<n;){if(!Array.isArray(t)&&t.subarray?i=t.subarray(r,r+b):i=t.slice(r,r+b),r+=b,S){e+=U.apply(null,i);continue}if(S===null)try{e+=U.apply(null,i),i.length>b&&F(!0);continue}catch{F(!1)}return Ze(t)}return e}function Ze(t){let e="",n=t.length;for(let r=0;r<n;r++)e+=U(t[r]);return e}function J(){let t=M>>7,e="        ";for(;!(t&M);)e+=e,t<<=1;return e}var B=class{_data=null;_table=null;_result=null;_onDataCallback;_onEndCallback;_offset=0;_dataLen=0;_index=0;_length=0;constructor(e){this._init(e)}_init(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}_createTable(){let e=G(8,p);for(let n=0;n<p;n++)e[n]=P.charCodeAt(n);return e}_onData(e,n){let r=q(e,n);this._onDataCallback?this._onDataCallback(r):this._result!==null&&(this._result+=r)}_onEnd(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null}_search(){let e=2,n=this._data,r=this._offset,i=x;if(this._dataLen-r<i&&(i=this._dataLen-r),e>i)return!1;let a=r-j,s=n.substring(a,r+i),c=r+e-3-a,f,_,l,u,d,m;do{if(e===2){if(_=n.charAt(r)+n.charAt(r+1),l=s.indexOf(_),l===-1||l>c)break}else e===3?_=_+n.charAt(r+2):_=n.substr(r,e);if(pe?(m=n.substring(a,r+e-1),u=m.lastIndexOf(_)):u=s.lastIndexOf(_,c),u===-1)break;d=u,f=a+u;do if(n.charCodeAt(r+e)!==n.charCodeAt(f+e))break;while(++e<i);if(l===u){e++;break}}while(++e<i);return e===2?!1:(this._index=j-d,this._length=e-1,!0)}compress(e){if(e==null||e.length===0)return"";let n="",r=this._createTable(),i=J(),a=G(8,K),s=0;this._result="",this._offset=i.length,this._data=i+e,this._dataLen=this._data.length;let c=-1,f=-1,_,l,u,d,m;for(;this._offset<this._dataLen;)this._search()?(this._index<x?(l=this._index,u=0):(l=this._index%x,u=(this._index-l)/x),this._length===2?(a[s++]=r[u+L],a[s++]=r[l]):(a[s++]=r[u+k],a[s++]=r[l],a[s++]=r[this._length]),this._offset+=this._length,~f&&(f=-1)):(_=this._data.charCodeAt(this._offset++),_<me?(_<g?(l=_,c=Z):(l=_%g,u=(_-l)/g,c=u+Z),f===c?a[s++]=r[l]:(a[s++]=r[c-he],a[s++]=r[l],f=c)):(_<N?(c=V,l=_):(l=_%N,u=(_-l)/N,c=u+V),l<g?(d=l,m=0):(d=l%g,m=(l-d)/g),f===c?(a[s++]=r[d],a[s++]=r[m]):(a[s++]=r[X],a[s++]=r[c-p],a[s++]=r[d],a[s++]=r[m],f=c))),s>=be&&(this._onData(a,s),s=0);return s>0&&this._onData(a,s),this._onEnd(),n=this._result,this._result=null,n===null?"":n}};function Ae(t,e){return new B(e).compress(t)}function Q(t){let e=/^v?(\d+)\.(\d+)\.(\d+)$/.exec(t);return e?{major:Number(e[1]),minor:Number(e[2]),patch:Number(e[3])}:null}function ye(t,e){return t.major!==e.major?{kind:"err",message:`MAJOR mismatch: ts=${t.major}, rust=${e.major}`}:t.minor!==e.minor?{kind:"err",message:`MINOR mismatch: ts=${t.minor}, rust=${e.minor}`}:t.patch!==e.patch?{kind:"warn",message:`PATCH mismatch: ts=${t.patch}, rust=${e.patch}`}:{kind:"ok"}}var Ce="v0.4.1";var Se=class{_wasm=null;_isInitialized=!1;constructor(e=!1){E.isDebug=e}async init(e){if(!this._isInitialized){try{await H(e)}catch(n){throw E.error("Failed to initialize SnowFall Wasm module:",n),n}this._wasm=z,this._versionCheck(),this._isInitialized=!0,E.info("SnowFall Wasm module initialized successfully.")}}ensureInitialized(){if(!this._wasm||!this._isInitialized)throw new Error("SnowFall has not been initialized. Please call init() first.");return this._wasm}version(){return Ce}version_wasm(){return this.ensureInitialized().version()}compile_bin(e,n){let i=this.ensureInitialized().compile(e,n);try{let a=i.errors;if(a){let c=a;if(Array.isArray(c)&&c.length>0)return{errors:c.map(f=>new C(f))}}let s=i.binary;return s?{binary:s}:{}}finally{i.free()}}compile(e,n){let r=this.compile_bin(e,n);return r.errors?{errors:r.errors}:r.binary?{data:Ae(se(r.binary))}:{}}dev_lexer(e){return this.ensureInitialized().lexer(e)}dev_parser(e){let r=this.ensureInitialized().parser(e);return r.errors?{...r,errors:r.errors.map(i=>new C(i))}:r}dev_normalize(e){let r=this.ensureInitialized().normalize(e);return r.errors?{...r,errors:r.errors.map(i=>new C(i))}:r}_versionCheck(){if(!this._wasm)return;let e=Q(this.version()),n=Q(this._wasm.version());if(!e||!n)throw new Error("Invalid version format (expected x.y.z)");let r=ye(e,n);switch(r.kind){case"ok":return;case"warn":E.warn("[Version]",r.message);return;case"err":throw new Error(`[Version] ${r.message}`)}}};export{Se as SnowFall};
/*!
 * lzbase62 v2.0.0 - LZ77(LZSS) based compression algorithm in base62 for JavaScript
 * Copyright (c) 2014-2020 polygon planet <polygon.planet.aqua@gmail.com>
 * https://github.com/polygonplanet/lzbase62
 * @license MIT
 *
 * Forked and modified by SnowFall2 Project
 * Modifications:
 * - Converted from JavaScript to TypeScript
 * - Added type definitions
 */
/**
 * forked from lzbase62
 * @module lzbase62
 * @see https://github.com/polygonplanet/lzbase62
 * @license MIT
 * @version 2.0.0
 */
//# sourceMappingURL=snowfall.min.js.map
