/*!
 * SnowFall2 v0.5.1
 * Copyright 2026 hi2ma-bu4
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var ve=Object.defineProperty;var Pe=(t,e)=>{for(var n in e)ve(t,n,{get:e[n],enumerable:!0})};var $={};Pe($,{WasmCompileResult:()=>R,compile:()=>ze,default:()=>V,execute:()=>Ye,free_memory:()=>je,free_memory_with_len:()=>Ke,initSync:()=>et,lexer:()=>Ze,main_init:()=>Ve,normalize:()=>$e,parser:()=>Ge,version:()=>qe});var o;function Xe(t){let e=o.__externref_table_alloc();return o.__wbindgen_externrefs.set(e,t),e}function _e(t,e){return t=t>>>0,T().subarray(t/1,t/1+e)}var y=null;function ce(){return(y===null||y.buffer.detached===!0||y.buffer.detached===void 0&&y.buffer!==o.memory.buffer)&&(y=new DataView(o.memory.buffer)),y}function M(t,e){return t=t>>>0,He(t,e)}var N=null;function T(){return(N===null||N.byteLength===0)&&(N=new Uint8Array(o.memory.buffer)),N}function ke(t,e){try{return t.apply(this,e)}catch(n){let r=Xe(n);o.__wbindgen_exn_store(r)}}function Le(t,e){let n=e(t.length*1,1)>>>0;return T().set(t,n/1),h=t.length,n}function B(t,e,n){if(n===void 0){let c=U.encode(t),u=e(c.length,1)>>>0;return T().subarray(u,u+c.length).set(c),h=c.length,u}let r=t.length,i=e(r,1)>>>0,a=T(),s=0;for(;s<r;s++){let c=t.charCodeAt(s);if(c>127)break;a[i+s]=c}if(s!==r){s!==0&&(t=t.slice(s)),i=n(i,r,r=s+t.length*3,1)>>>0;let c=T().subarray(i+s,i+r),u=U.encodeInto(t,c);s+=u.written,i=n(i,r,s,1)>>>0}return h=s,i}function E(t){let e=o.__wbindgen_externrefs.get(t);return o.__externref_table_dealloc(t),e}var Y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Y.decode();var We=2146435072,Z=0;function He(t,e){return Z+=e,Z>=We&&(Y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),Y.decode(),Z=e),Y.decode(T().subarray(t,t+e))}var U=new TextEncoder;"encodeInto"in U||(U.encodeInto=function(t,e){let n=U.encode(t);return e.set(n),{read:t.length,written:n.length}});var h=0,le=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>o.__wbg_wasmcompileresult_free(t>>>0,1)),R=class t{static __wrap(e){e=e>>>0;let n=Object.create(t.prototype);return n.__wbg_ptr=e,le.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,le.unregister(this),e}free(){let e=this.__destroy_into_raw();o.__wbg_wasmcompileresult_free(e,0)}get binary(){let e=o.wasmcompileresult_binary(this.__wbg_ptr),n;return e[0]!==0&&(n=_e(e[0],e[1]).slice(),o.__wbindgen_free(e[0],e[1]*1,1)),n}get errors(){return o.wasmcompileresult_errors(this.__wbg_ptr)}};Symbol.dispose&&(R.prototype[Symbol.dispose]=R.prototype.free);function ze(t,e){let n=B(t,o.__wbindgen_malloc,o.__wbindgen_realloc),r=h,i=o.compile(n,r,e);return R.__wrap(i)}function Ye(t){let e=Le(t,o.__wbindgen_malloc),n=h,r=o.execute(e,n);if(r[2])throw E(r[1]);return E(r[0])}function je(t,e){o.free_memory(t,e)}function Ke(t,e,n){o.free_memory_with_len(t,e,n)}function Ze(t){let e=B(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=h,r=o.lexer(e,n);if(r[2])throw E(r[1]);return E(r[0])}function Ve(){o.main_init()}function $e(t){let e=B(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=h,r=o.normalize(e,n);if(r[2])throw E(r[1]);return E(r[0])}function Ge(t){let e=B(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=h,r=o.parser(e,n);if(r[2])throw E(r[1]);return E(r[0])}function qe(){let t,e;try{let n=o.version();return t=n[0],e=n[1],M(n[0],n[1])}finally{o.__wbindgen_free(t,e,1)}}var Je=new Set(["basic","cors","default"]);async function Qe(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.ok&&Je.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}let n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{let n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function ue(){let t={};return t.wbg={},t.wbg.__wbg_Error_52673b7de5a0ca89=function(e,n){return Error(M(e,n))},t.wbg.__wbg___wbindgen_is_string_704ef9c8fc131030=function(e){return typeof e=="string"},t.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(e,n){throw new Error(M(e,n))},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,i;try{r=e,i=n,console.error(M(e,n))}finally{o.__wbindgen_free(r,i,1)}},t.wbg.__wbg_getRandomValues_1c61fac11405ffdc=function(){return ke(function(e,n){globalThis.crypto.getRandomValues(_e(e,n))},arguments)},t.wbg.__wbg_new_1ba21ce319a06297=function(){return new Object},t.wbg.__wbg_new_25f239778d6112b9=function(){return new Array},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_new_b546ae120718850e=function(){return new Map},t.wbg.__wbg_set_3f1d0b984ed272ed=function(e,n,r){e[n]=r},t.wbg.__wbg_set_7df433eea03a5c14=function(e,n,r){e[n>>>0]=r},t.wbg.__wbg_set_efaaf145b9377369=function(e,n,r){return e.set(n,r)},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){let r=n.stack,i=B(r,o.__wbindgen_malloc,o.__wbindgen_realloc),a=h;ce().setInt32(e+4,a,!0),ce().setInt32(e+0,i,!0)},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,n){return M(e,n)},t.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},t.wbg.__wbindgen_cast_9ae0607507abb057=function(e){return e},t.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(e){return e},t.wbg.__wbindgen_init_externref_table=function(){let e=o.__wbindgen_externrefs,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t}function fe(t,e){return o=t.exports,pe.__wbindgen_wasm_module=e,y=null,N=null,o.__wbindgen_start(),o}function et(t){if(o!==void 0)return o;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module:t}=t:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));let e=ue();t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t));let n=new WebAssembly.Instance(t,e);return fe(n,t)}async function pe(t){if(o!==void 0)return o;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("snowfall_core_bg.wasm",import.meta.url));let e=ue();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));let{instance:n,module:r}=await Qe(await t,e);return fe(n,r)}var V=pe;var C=class extends Error{type;code;line;column;trace;context;constructor(e){super(e.message),this.name=this.constructor.name,this.type=e.type,this.code=e.code,this.line=e.line,this.column=e.column,this.trace=e.trace,this.context=e.context,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}};function ge(t){let e="";for(let n=0;n<t.length;n+=16384)e+=String.fromCharCode(...t.subarray(n,n+16384));return e}function be(t){let e=t.length,n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t.charCodeAt(r);return n}var S=class{static isDebug=!1;static prefix="SnowFall";static info(...e){this.isDebug&&console.log(`[${this.prefix}]`,...e)}static warn(...e){console.warn(`[${this.prefix}]`,...e)}static error(...e){console.error(`[${this.prefix}]`,...e)}};var G=typeof Uint8Array<"u"&&typeof Uint16Array<"u",me=!1;try{String.fromCharCode.apply(null,[97])==="a"&&(me=!0)}catch{}var he=me,we=!1;if(G)try{String.fromCharCode.apply(null,new Uint8Array([97]))==="a"&&(we=!0)}catch{}var Ee=we,w=65533,D=null;function v(t){D=t}var Ae=!1;"abc\u307B\u3052".lastIndexOf("\u307B\u3052",1)!==-1&&(Ae=!0);var ye=Ae,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",p=P.length,Ce=Math.max(p,62)-Math.min(p,62),A=p-1,m=1024,q=304,J=w,Se=J-p,Q=w,xe=Q+m*2,de=11,Ie=de*(de+1),g=40,O=g*(g+1),ee=p+1,Te=Ce+20,te=p+5,ne=p-Ce-19,re=g+7,X=re+1,k=X+1,F=k+5,Re=F+5;var L=String.fromCharCode;function oe(t,e){if(G)switch(t){case 8:return new Uint8Array(e);case 16:return new Uint16Array(e)}return new Array(e)}function tt(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)}function W(t,e){if(e==null?e=t.length:t=tt(t,e),he&&Ee){let n=t.length;if(n<w&&D)return L.apply(null,t);if(D===null)try{let r=L.apply(null,t);return n>w&&v(!0),r}catch{v(!1)}}return nt(t)}function nt(t){let e="",n=t.length,r=0,i;for(;r<n;){if(!Array.isArray(t)&&t.subarray?i=t.subarray(r,r+w):i=t.slice(r,r+w),r+=w,D){e+=L.apply(null,i);continue}if(D===null)try{e+=L.apply(null,i),i.length>w&&v(!0);continue}catch{v(!1)}return rt(t)}return e}function rt(t){let e="",n=t.length;for(let r=0;r<n;r++)e+=L(t[r]);return e}function De(t){if(!t)return[];let e=[],n=t?t.length:0;for(let r=0;r<n;r++)e[r]=t.charCodeAt(r);return e}function j(){let t=m>>7,e="        ";for(;!(t&m);)e+=e,t<<=1;return e}var H=class{_data=null;_table=null;_result=null;_onDataCallback;_onEndCallback;_offset=0;_dataLen=0;_index=0;_length=0;constructor(e){this._init(e)}_init(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}_createTable(){let e=oe(8,p);for(let n=0;n<p;n++)e[n]=P.charCodeAt(n);return e}_onData(e,n){let r=W(e,n);this._onDataCallback?this._onDataCallback(r):this._result!==null&&(this._result+=r)}_onEnd(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null}_search(){let e=2,n=this._data,r=this._offset,i=A;if(this._dataLen-r<i&&(i=this._dataLen-r),e>i)return!1;let a=r-q,s=n.substring(a,r+i),c=r+e-3-a,u,l,_,f,b,d;do{if(e===2){if(l=n.charAt(r)+n.charAt(r+1),_=s.indexOf(l),_===-1||_>c)break}else e===3?l=l+n.charAt(r+2):l=n.substr(r,e);if(ye?(d=n.substring(a,r+e-1),f=d.lastIndexOf(l)):f=s.lastIndexOf(l,c),f===-1)break;b=f,u=a+f;do if(n.charCodeAt(r+e)!==n.charCodeAt(u+e))break;while(++e<i);if(_===f){e++;break}}while(++e<i);return e===2?!1:(this._index=q-b,this._length=e-1,!0)}compress(e){if(e==null||e.length===0)return"";let n="",r=this._createTable(),i=j(),a=oe(8,J),s=0;this._result="",this._offset=i.length,this._data=i+e,this._dataLen=this._data.length;let c=-1,u=-1,l,_,f,b,d;for(;this._offset<this._dataLen;)this._search()?(this._index<A?(_=this._index,f=0):(_=this._index%A,f=(this._index-_)/A),this._length===2?(a[s++]=r[f+F],a[s++]=r[_]):(a[s++]=r[f+k],a[s++]=r[_],a[s++]=r[this._length]),this._offset+=this._length,~u&&(u=-1)):(l=this._data.charCodeAt(this._offset++),l<Ie?(l<g?(_=l,c=ee):(_=l%g,f=(l-_)/g,c=f+ee),u===c?a[s++]=r[_]:(a[s++]=r[c-Te],a[s++]=r[_],u=c)):(l<O?(c=te,_=l):(_=l%O,f=(l-_)/O,c=f+te),_<g?(b=_,d=0):(b=_%g,d=(_-b)/g),u===c?(a[s++]=r[b],a[s++]=r[d]):(a[s++]=r[X],a[s++]=r[c-p],a[s++]=r[b],a[s++]=r[d],u=c))),s>=Se&&(this._onData(a,s),s=0);return s>0&&this._onData(a,s),this._onEnd(),n=this._result,this._result=null,n===null?"":n}};var z=class{_result=null;_onDataCallback;_onEndCallback;constructor(e){this._init(e)}_init(e){e=e||{},this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd}_createTable(){let e={};for(let n=0;n<p;n++)e[P.charAt(n)]=n;return e}_onData(e=!1){if(!this._onDataCallback||!this._result)return;let n;if(e)n=this._result,this._result=[];else{let r=Q-m;n=this._result.slice(m,m+r),this._result=this._result.slice(0,m).concat(this._result.slice(m+r))}n.length>0&&this._onDataCallback(W(n))}_onEnd(){this._onEndCallback&&this._onEndCallback()}decompress(e){if(e==null||e.length===0)return"";this._result=De(j());let n="",r=this._createTable(),i=!1,a=null,s=e.length,c=0,u,l,_,f,b,d,x,I,ae,K;for(;c<s;c++)if(l=r[e.charAt(c)],l!==void 0){if(l<ne)i?(f=r[e.charAt(++c)],b=f*g+l+O*a):b=a*g+l,this._result[this._result.length]=b;else if(l<re)a=l-ne,i=!1;else if(l===X)_=r[e.charAt(++c)],a=_-5,i=!0;else if(l<Re){if(_=r[e.charAt(++c)],l<F?(d=(l-k)*A+_,x=r[e.charAt(++c)]):(d=(l-F)*A+_,x=2),I=this._result.slice(-d),I.length>x&&(I.length=x),ae=I.length,I.length>0)for(K=0;K<x;)for(u=0;u<ae&&(this._result[this._result.length]=I[u],!(++K>=x));u++);a=null}this._result.length>=xe&&this._onData()}return this._result=this._result.slice(m),this._onData(!0),this._onEnd(),n=W(this._result),this._result=null,n}};function Fe(t,e){return new H(e).compress(t)}function Me(t,e){return new z(e).decompress(t)}function se(t){let e=/^v?(\d+)\.(\d+)\.(\d+)$/.exec(t);return e?{major:Number(e[1]),minor:Number(e[2]),patch:Number(e[3])}:null}function Ne(t,e){return t.major!==e.major?{kind:"err",message:`MAJOR mismatch: ts=${t.major}, rust=${e.major}`}:t.minor!==e.minor?{kind:"err",message:`MINOR mismatch: ts=${t.minor}, rust=${e.minor}`}:t.patch!==e.patch?{kind:"warn",message:`PATCH mismatch: ts=${t.patch}, rust=${e.patch}`}:{kind:"ok"}}var Ue="v0.5.1";var Be=class{_wasm=null;_isInitialized=!1;constructor(e=!1){S.isDebug=e}async init(e){if(!this._isInitialized){try{await V(e)}catch(n){throw S.error("Failed to initialize SnowFall Wasm module:",n),n}this._wasm=$,this._versionCheck(),this._isInitialized=!0,S.info("SnowFall Wasm module initialized successfully.")}}ensureInitialized(){if(!this._wasm||!this._isInitialized)throw new Error("SnowFall has not been initialized. Please call init() first.");return this._wasm}version(){return Ue}version_wasm(){return this.ensureInitialized().version()}compile_bin(e,n){let i=this.ensureInitialized().compile(e,n);try{let a=i.errors;if(a){let c=a;if(Array.isArray(c)&&c.length>0)return{errors:c.map(u=>new C(u))}}let s=i.binary;return s?{binary:s}:{}}finally{i.free()}}compile(e,n){let r=this.compile_bin(e,n);return r.errors?{errors:r.errors}:r.binary?{data:Fe(ge(r.binary))}:{}}execute_bin(e){let n=this.ensureInitialized();try{return n.execute(e)}catch(r){throw new C(r)}}execute(e){return this.execute_bin(be(Me(e)))}dev_lexer(e){return this.ensureInitialized().lexer(e)}dev_parser(e){let r=this.ensureInitialized().parser(e);return r.errors?{...r,errors:r.errors.map(i=>new C(i))}:r}dev_normalize(e){let r=this.ensureInitialized().normalize(e);return r.errors?{...r,errors:r.errors.map(i=>new C(i))}:r}_versionCheck(){if(!this._wasm)return;let e=se(this.version()),n=se(this._wasm.version());if(!e||!n)throw new Error("Invalid version format (expected x.y.z)");let r=Ne(e,n);switch(r.kind){case"ok":return;case"warn":S.warn("[Version]",r.message);return;case"err":throw new Error(`[Version] ${r.message}`)}}};export{Be as SnowFall};
/*!
 * lzbase62 v2.0.0 - LZ77(LZSS) based compression algorithm in base62 for JavaScript
 * Copyright (c) 2014-2020 polygon planet <polygon.planet.aqua@gmail.com>
 * https://github.com/polygonplanet/lzbase62
 * @license MIT
 *
 * Forked and modified by SnowFall2 Project
 * Modifications:
 * - Converted from JavaScript to TypeScript
 * - Added type definitions
 */
/**
 * forked from lzbase62
 * @module lzbase62
 * @see https://github.com/polygonplanet/lzbase62
 * @license MIT
 * @version 2.0.0
 */
//# sourceMappingURL=snowfall.min.js.map
